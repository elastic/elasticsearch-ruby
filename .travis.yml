# -----------------------------------------------------------------------
# Configuration file for https://travis-ci.org/elastic/elasticsearch-ruby
# -----------------------------------------------------------------------

dist: trusty

sudo: required

language: ruby

branches:
  only:
    - master
    - 7.x
    - 6.x
    - travis
matrix:
  include:
    # Unit tests
    - rvm: ruby-head
      jdk: oraclejdk8
      env: TEST_SUITE=client

    - rvm: 2.7.0
      jdk: oraclejdk8
      env: TEST_SUITE=client

    - rvm: 2.6.5
      jdk: oraclejdk8
      env: TEST_SUITE=client

    - rvm: 2.5.7
      jdk: oraclejdk8
      env: TEST_SUITE=client

    - rvm: jruby-9.2.11.0
      jdk: oraclejdk8
      env: TEST_SUITE=client

  allow_failures:
    - rvm: ruby-head
      jdk: oraclejdk8
      env: TEST_SUITE=client

before_install:
  - ls $PWD
  - gem --version
  - gem update bundler -q
  - bundle version
  - bundle install
  - bundle exec rake setup

install:
  - rake bundle:clean
  - rake bundle:install

script:
  - rake test:$TEST_SUITE

notifications:
  disable: true
